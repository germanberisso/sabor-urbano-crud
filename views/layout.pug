// Define el tipo de documento HTML5
doctype html
// Configura el documento HTML con idioma español
html(lang="es")
  head
    // Configura codificación y viewport para responsividad
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    // Establece el título dinámico o por defecto
    title= title || 'Sabor Urbano - Sistema de Gestión'
    // Incluye Bootstrap CSS para estilos
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css", rel="stylesheet")
    // Incluye Font Awesome para íconos
    link(href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css", rel="stylesheet")
    // Define estilos personalizados
    style.
      .navbar-brand {
        font-weight: bold;
        color: #ff6b35 !important; // Color personalizado para la marca
      }
      .card {
        border: none;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1); // Sombra para tarjetas
        transition: transform 0.3s; // Efecto de transición al interactuar
      }
      .card:hover {
        transform: translateY(-5px); // Efecto de elevación al pasar el ratón
      }
      .bg-gradient-orange {
        background: linear-gradient(135deg, #ff6b35, #f7931e); // Gradiente naranja
      }
      .bg-gradient-blue {
        background: linear-gradient(135deg, #007bff, #6610f2); // Gradiente azul
      }
      .bg-gradient-green {
        background: linear-gradient(135deg, #28a745, #20c997); // Gradiente verde
      }
      .bg-gradient-red {
        background: linear-gradient(135deg, #dc3545, #e83e8c); // Gradiente rojo
      }
      .sidebar {
        min-height: 100vh; // Altura completa para la barra lateral
        background: #f8f9fa; // Fondo claro para la barra lateral
      }
      .main-content {
        min-height: 100vh; // Altura completa para el contenido principal
      }

  body
    // Barra de navegación superior
    nav.navbar.navbar-expand-lg.navbar-dark.bg-dark
      .container-fluid
        // Enlace a la página principal con ícono
        a.navbar-brand(href="/")
          i.fas.fa-utensils.me-2
          | Sabor Urbano
        // Botón para menú colapsable en dispositivos móviles
        button.navbar-toggler(type="button", data-bs-toggle="collapse", data-bs-target="#navbarNav")
          span.navbar-toggler-icon
        // Menú de navegación
        .collapse.navbar-collapse#navbarNav
          ul.navbar-nav.me-auto
            // Enlaces de navegación con íconos
            li.nav-item
              a.nav-link(href="/", class= page === 'home' ? 'active' : '')
                i.fas.fa-home.me-1
                | Dashboard
            li.nav-item
              a.nav-link(href="/tareas", class= page === 'tareas' ? 'active' : '')
                i.fas.fa-tasks.me-1
                | Tareas
            li.nav-item
              a.nav-link(href="/empleados", class= page === 'empleados' ? 'active' : '')
                i.fas.fa-users.me-1
                | Empleados
            li.nav-item
              a.nav-link(href="/filtros", class= page === 'filtros' ? 'active' : '')
                i.fas.fa-filter.me-1
                | Filtros
          // Fecha y hora actual en la barra de navegación
          ul.navbar-nav
            li.nav-item
              span.navbar-text
                i.fas.fa-clock.me-1
                | #{new Date().toLocaleString('es-AR')}

    // Contenedor principal con diseño de cuadrícula
    .container-fluid
      .row
        // Barra lateral para navegación secundaria (visible en pantallas grandes)
        .col-md-2.sidebar.p-3.d-none.d-md-block
          h6.text-muted.text-uppercase.mb-3 Navegación
          ul.nav.flex-column
            // Enlaces a endpoints de la API
            li.nav-item
              a.nav-link(href="/api/tareas", target="_blank")
                i.fas.fa-code.me-2
                | API Tareas
            li.nav-item
              a.nav-link(href="/api/empleados", target="_blank")
                i.fas.fa-code.me-2
                | API Empleados
            li.nav-item
              a.nav-link(href="/api/pedidos", target="_blank")
                i.fas.fa-code.me-2
                | API Pedidos
            li.nav-item
              a.nav-link(href="/api/insumos", target="_blank")
                i.fas.fa-code.me-2
                | API Insumos
          hr
          h6.text-muted.text-uppercase.mb-3 Estadísticas
          ul.nav.flex-column
            // Enlaces a estadísticas de la API
            li.nav-item
              a.nav-link(href="/api/tareas/estadisticas", target="_blank")
                i.fas.fa-chart-bar.me-2
                | Stats Tareas
            li.nav-item
              a.nav-link(href="/api/empleados/estadisticas", target="_blank")
                i.fas.fa-chart-pie.me-2
                | Stats Empleados

        // Área de contenido principal
        .col-md-10.main-content.p-4
          // Muestra alertas de error si existen
          if error
            .alert.alert-danger.alert-dismissible.fade.show
              i.fas.fa-exclamation-triangle.me-2
              strong Error: 
              | #{error}
              button.btn-close(type="button", data-bs-dismiss="alert")
          
          // Bloque para contenido específico de cada página
          block content

    // Incluye Bootstrap JS para funcionalidades interactivas
    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js")
    // Script para auto-refresh del dashboard
    script.
      // Recarga la página cada 30 segundos si es el dashboard y no está oculta
      if (window.location.pathname === '/') {
        setInterval(() => {
          if (!document.hidden) {
            location.reload();
          }
        }, 30000);
      }